#include <audio_filters/filters.h>
#include <vector>
#include <cstdint>

namespace
{
// FIR filter Equiripple Fpass 180Hz Fstop 400Hz
const std::vector<float> lowpas180FIR_constants = {
    0.013867166026352028F,
    -0.0030270975124599545F,
    -0.0027406343944884845F,
    -0.002498992000584715F,
    -0.002295086689284627F,
    -0.002124984084089238F,
    -0.001982981548333204F,
    -0.0018663980271248098F,
    -0.0017704542079909674F,
    -0.0016935906320908398F,
    -0.0016320268648765807F,
    -0.0015846048790316535F,
    -0.0015481436779812955F,
    -0.0015223102031860717F,
    -0.0015044386999045513F,
    -0.0014944153107199756F,
    -0.0014896763629732785F,
    -0.0014905623706474825F,
    -0.0014948552439753952F,
    -0.0015032523773156673F,
    -0.0015135452871817383F,
    -0.0015266676510305747F,
    -0.001540417954324763F,
    -0.0015560528188999316F,
    -0.001571368875382286F,
    -0.0015879511892232996F,
    -0.0016033920777164142F,
    -0.001619504847688324F,
    -0.0016336660418178224F,
    -0.001648168918973219F,
    -0.001660037213108431F,
    -0.0016718979626655199F,
    -0.0016802824773608988F,
    -0.0016887131306302897F,
    -0.0016931386723602687F,
    -0.0016977434915090872F,
    -0.0016970443657213395F,
    -0.001696997112167422F,
    -0.001690574459704803F,
    -0.0016862679968556963F,
    -0.0016719369007200584F,
    -0.0016664904720785681F,
    -0.0016382024028993403F,
    -0.0016291211316251373F,
    -0.0016094849844475382F,
    -0.0015696853580775586F,
    -0.0015446741978852564F,
    -0.0015148550944430329F,
    -0.0014818329337368296F,
    -0.0014370190805574527F,
    -0.0013904987054368715F,
    -0.0013393096814447918F,
    -0.001289271059986923F,
    -0.0012341248239037907F,
    -0.0011765335024177348F,
    -0.0011115728959255053F,
    -0.0010429685459820031F,
    -0.0009678709138054044F,
    -0.0008903608857201417F,
    -0.0008080737608773295F,
    -0.0007240500041011433F,
    -0.0006352440948222715F,
    -0.0005436231336939298F,
    -0.0004462557347190649F,
    -0.0003452036673472499F,
    -0.00023831873534940689F,
    -0.0001278831836205891F,
    -1.2172926232413058e-05F,
    0.00010672882565992361F,
    0.00023035698910376165F,
    0.0003567945341954294F,
    0.0004874593390180456F,
    0.0006209970908414817F,
    0.0007590003196620545F,
    0.0009003442507431097F,
    0.0010460332713627043F,
    0.001195037456997577F,
    0.0013482743515683612F,
    0.001505132995525467F,
    0.001665633013470259F,
    0.0018292421996026706F,
    0.0019957470008351275F,
    0.0021662346866639023F,
    0.0023382119095541397F,
    0.0025136802024784354F,
    0.002692431055680242F,
    0.0028691561415882093F,
    0.0030556220741550857F,
    0.003238534529833021F,
    0.003424733702436464F,
    0.0036135052080332256F,
    0.0038069863383502728F,
    0.003998993567079897F,
    0.004193394646973483F,
    0.004388055807890042F,
    0.004586603920524534F,
    0.004785055781229473F,
    0.004985156703710067F,
    0.0051837181305419994F,
    0.005383771018248267F,
    0.005583060065680601F,
    0.0057840844593372315F,
    0.005983987306773851F,
    0.006184720258983097F,
    0.006383553926348209F,
    0.006582630920864207F,
    0.006779695378968565F,
    0.0069770766827858995F,
    0.007172578324212855F,
    0.007368145509644497F,
    0.007561215764270953F,
    0.0077533776569237356F,
    0.007942189269936652F,
    0.008129643597757636F,
    0.008313879093317256F,
    0.008496922270719978F,
    0.008676459162706552F,
    0.00885396574129121F,
    0.009027265419528531F,
    0.009198283167035096F,
    0.00936492552059323F,
    0.009528584273495714F,
    0.0096870453913625F,
    0.009842520382318998F,
    0.00999342985856332F,
    0.010141251745579938F,
    0.010282633652340067F,
    0.010422323775888226F,
    0.010554502574356238F,
    0.010684320930032588F,
    0.010807357945898745F,
    0.010925590090336093F,
    0.011037813784510561F,
    0.011146859341151378F,
    0.01124788023007623F,
    0.011344732444047326F,
    0.011435267267812533F,
    0.011521601811124205F,
    0.011600455190413566F,
    0.011674079933491037F,
    0.011740642788635562F,
    0.011802679347550298F,
    0.011857611565899982F,
    0.011907069598256118F,
    0.011948629824973304F,
    0.011984595152290578F,
    0.012013072095639763F,
    0.012036299203648862F,
    0.01205211316441053F,
    0.012062515351530292F,
    0.012065294439977765F,
    0.012062515351530292F,
    0.01205211316441053F,
    0.012036299203648862F,
    0.012013072095639763F,
    0.011984595152290578F,
    0.011948629824973304F,
    0.011907069598256118F,
    0.011857611565899982F,
    0.011802679347550298F,
    0.011740642788635562F,
    0.011674079933491037F,
    0.011600455190413566F,
    0.011521601811124205F,
    0.011435267267812533F,
    0.011344732444047326F,
    0.01124788023007623F,
    0.011146859341151378F,
    0.011037813784510561F,
    0.010925590090336093F,
    0.010807357945898745F,
    0.010684320930032588F,
    0.010554502574356238F,
    0.010422323775888226F,
    0.010282633652340067F,
    0.010141251745579938F,
    0.00999342985856332F,
    0.009842520382318998F,
    0.0096870453913625F,
    0.009528584273495714F,
    0.00936492552059323F,
    0.009198283167035096F,
    0.009027265419528531F,
    0.00885396574129121F,
    0.008676459162706552F,
    0.008496922270719978F,
    0.008313879093317256F,
    0.008129643597757636F,
    0.007942189269936652F,
    0.0077533776569237356F,
    0.007561215764270953F,
    0.007368145509644497F,
    0.007172578324212855F,
    0.0069770766827858995F,
    0.006779695378968565F,
    0.006582630920864207F,
    0.006383553926348209F,
    0.006184720258983097F,
    0.005983987306773851F,
    0.0057840844593372315F,
    0.005583060065680601F,
    0.005383771018248267F,
    0.0051837181305419994F,
    0.004985156703710067F,
    0.004785055781229473F,
    0.004586603920524534F,
    0.004388055807890042F,
    0.004193394646973483F,
    0.003998993567079897F,
    0.0038069863383502728F,
    0.0036135052080332256F,
    0.003424733702436464F,
    0.003238534529833021F,
    0.0030556220741550857F,
    0.0028691561415882093F,
    0.002692431055680242F,
    0.0025136802024784354F,
    0.0023382119095541397F,
    0.0021662346866639023F,
    0.0019957470008351275F,
    0.0018292421996026706F,
    0.001665633013470259F,
    0.001505132995525467F,
    0.0013482743515683612F,
    0.001195037456997577F,
    0.0010460332713627043F,
    0.0009003442507431097F,
    0.0007590003196620545F,
    0.0006209970908414817F,
    0.0004874593390180456F,
    0.0003567945341954294F,
    0.00023035698910376165F,
    0.00010672882565992361F,
    -1.2172926232413058e-05F,
    -0.0001278831836205891F,
    -0.00023831873534940689F,
    -0.0003452036673472499F,
    -0.0004462557347190649F,
    -0.0005436231336939298F,
    -0.0006352440948222715F,
    -0.0007240500041011433F,
    -0.0008080737608773295F,
    -0.0008903608857201417F,
    -0.0009678709138054044F,
    -0.0010429685459820031F,
    -0.0011115728959255053F,
    -0.0011765335024177348F,
    -0.0012341248239037907F,
    -0.001289271059986923F,
    -0.0013393096814447918F,
    -0.0013904987054368715F,
    -0.0014370190805574527F,
    -0.0014818329337368296F,
    -0.0015148550944430329F,
    -0.0015446741978852564F,
    -0.0015696853580775586F,
    -0.0016094849844475382F,
    -0.0016291211316251373F,
    -0.0016382024028993403F,
    -0.0016664904720785681F,
    -0.0016719369007200584F,
    -0.0016862679968556963F,
    -0.001690574459704803F,
    -0.001696997112167422F,
    -0.0016970443657213395F,
    -0.0016977434915090872F,
    -0.0016931386723602687F,
    -0.0016887131306302897F,
    -0.0016802824773608988F,
    -0.0016718979626655199F,
    -0.001660037213108431F,
    -0.001648168918973219F,
    -0.0016336660418178224F,
    -0.001619504847688324F,
    -0.0016033920777164142F,
    -0.0015879511892232996F,
    -0.001571368875382286F,
    -0.0015560528188999316F,
    -0.001540417954324763F,
    -0.0015266676510305747F,
    -0.0015135452871817383F,
    -0.0015032523773156673F,
    -0.0014948552439753952F,
    -0.0014905623706474825F,
    -0.0014896763629732785F,
    -0.0014944153107199756F,
    -0.0015044386999045513F,
    -0.0015223102031860717F,
    -0.0015481436779812955F,
    -0.0015846048790316535F,
    -0.0016320268648765807F,
    -0.0016935906320908398F,
    -0.0017704542079909674F,
    -0.0018663980271248098F,
    -0.001982981548333204F,
    -0.002124984084089238F,
    -0.002295086689284627F,
    -0.002498992000584715F,
    -0.0027406343944884845F,
    -0.0030270975124599545F,
    0.013867166026352028F,
};

const std::vector<float> lowpass100hzstop180hz = {
    -0.09390677613023295F,
    0.005452442175058255F,
    0.005307622854613014F,
    0.005160808873442963F,
    0.005032224083458147F,
    0.004901117371223843F,
    0.0047879388073091955F,
    0.004670959581939623F,
    0.00457088504327278F,
    0.004465872524404819F,
    0.004378147037291539F,
    0.004286707631646745F,
    0.004211089968166164F,
    0.004129238097103514F,
    0.004063282022264177F,
    0.003993925312795654F,
    0.0039370962752445565F,
    0.0038758285248826395F,
    0.0038295029399845744F,
    0.0037753548158881343F,
    0.0037378353735095984F,
    0.0036913591955434924F,
    0.0036614145330934452F,
    0.0036211064703474335F,
    0.0035985492633442825F,
    0.003565258802830846F,
    0.003548563821107134F,
    0.003522367354657968F,
    0.003511820131210432F,
    0.0034895835253870356F,
    0.003486395831616725F,
    0.003468793326947618F,
    0.003470707826940319F,
    0.003455234234326036F,
    0.0034643361610111898F,
    0.003451050121099712F,
    0.003467393510700349F,
    0.003452116145944299F,
    0.003479402664862403F,
    0.003448782878617229F,
    0.0034990187398764353F,
    0.003546069865881963F,
    0.003430903615641381F,
    0.0034944358823863035F,
    0.003518558778359206F,
    0.0035640866076755056F,
    0.0035762596842920514F,
    0.00359718205409165F,
    0.003602406370502538F,
    0.0036180717976579107F,
    0.0036286548061116365F,
    0.0036476590403151086F,
    0.00366497960822129F,
    0.003690503727592684F,
    0.003717670475508848F,
    0.003746978058280739F,
    0.0037742544982577843F,
    0.0038074711535440267F,
    0.0038356500365063304F,
    0.003866624707917216F,
    0.0038955985002396354F,
    0.003923934620421788F,
    0.003952329302252886F,
    0.003979429385941372F,
    0.004008344021598591F,
    0.004034201271237256F,
    0.004063820835888089F,
    0.004090979108189827F,
    0.004121331629547848F,
    0.00415055085452487F,
    0.0041830769145344F,
    0.004212599496976221F,
    0.004246605888121547F,
    0.004277538948336059F,
    0.004313021704037351F,
    0.0043425447813306385F,
    0.0043793544002008085F,
    0.004408166148421226F,
    0.004447743367050003F,
    0.004472931946498767F,
    0.004521100401172588F,
    0.00453128941072089F,
    0.004574555973471535F,
    0.004624998677751984F,
    0.0046378050899533235F,
    0.0046667871975693805F,
    0.0046954807291005604F,
    0.004734269290831F,
    0.004767549973835965F,
    0.004800672646727295F,
    0.004827860647528872F,
    0.004854971513226185F,
    0.004882127364363428F,
    0.004909826008587973F,
    0.004936846884256492F,
    0.004962239766492737F,
    0.004994855557520444F,
    0.005024535258228666F,
    0.005052033878326738F,
    0.005083148283338813F,
    0.00510993958756638F,
    0.005138394169712554F,
    0.005164875933649157F,
    0.00519132884600852F,
    0.005216758168984236F,
    0.005241864841590865F,
    0.005268099915621496F,
    0.005292255465758732F,
    0.005318132008509127F,
    0.005342460374820408F,
    0.005367671475562928F,
    0.005391638824367437F,
    0.005416612691279171F,
    0.005439412342439148F,
    0.005461927434263505F,
    0.005483098719595924F,
    0.005504327759306833F,
    0.0055226983245435235F,
    0.005541844539407195F,
    0.005558022861326333F,
    0.0055777575025307375F,
    0.005589169636510876F,
    0.005618409863412255F,
    0.005622843735650625F,
    0.005639962822235953F,
    0.005661734660725556F,
    0.00567746658618619F,
    0.005688875056036054F,
    0.005700441350996627F,
    0.005714227640092359F,
    0.005730294871814745F,
    0.005745179131823882F,
    0.005758208552271433F,
    0.005766503418617705F,
    0.005776342201765419F,
    0.005786406144419296F,
    0.005799106877633795F,
    0.005799212831617924F,
    0.005812364507610571F,
    0.005819873981919958F,
    0.00582688794235429F,
    0.005834561598232195F,
    0.005839793365953999F,
    0.005844756233730441F,
    0.005848345582843195F,
    0.005851539811225569F,
    0.0058533188927517845F,
    0.005854085831873664F,
    0.005855710884918916F,
    0.0058556421743832365F,
    0.005856333971104369F,
    0.0058556421743832365F,
    0.005855710884918916F,
    0.005854085831873664F,
    0.0058533188927517845F,
    0.005851539811225569F,
    0.005848345582843195F,
    0.005844756233730441F,
    0.005839793365953999F,
    0.005834561598232195F,
    0.00582688794235429F,
    0.005819873981919958F,
    0.005812364507610571F,
    0.005799212831617924F,
    0.005799106877633795F,
    0.005786406144419296F,
    0.005776342201765419F,
    0.005766503418617705F,
    0.005758208552271433F,
    0.005745179131823882F,
    0.005730294871814745F,
    0.005714227640092359F,
    0.005700441350996627F,
    0.005688875056036054F,
    0.00567746658618619F,
    0.005661734660725556F,
    0.005639962822235953F,
    0.005622843735650625F,
    0.005618409863412255F,
    0.005589169636510876F,
    0.0055777575025307375F,
    0.005558022861326333F,
    0.005541844539407195F,
    0.0055226983245435235F,
    0.005504327759306833F,
    0.005483098719595924F,
    0.005461927434263505F,
    0.005439412342439148F,
    0.005416612691279171F,
    0.005391638824367437F,
    0.005367671475562928F,
    0.005342460374820408F,
    0.005318132008509127F,
    0.005292255465758732F,
    0.005268099915621496F,
    0.005241864841590865F,
    0.005216758168984236F,
    0.00519132884600852F,
    0.005164875933649157F,
    0.005138394169712554F,
    0.00510993958756638F,
    0.005083148283338813F,
    0.005052033878326738F,
    0.005024535258228666F,
    0.004994855557520444F,
    0.004962239766492737F,
    0.004936846884256492F,
    0.004909826008587973F,
    0.004882127364363428F,
    0.004854971513226185F,
    0.004827860647528872F,
    0.004800672646727295F,
    0.004767549973835965F,
    0.004734269290831F,
    0.0046954807291005604F,
    0.0046667871975693805F,
    0.0046378050899533235F,
    0.004624998677751984F,
    0.004574555973471535F,
    0.00453128941072089F,
    0.004521100401172588F,
    0.004472931946498767F,
    0.004447743367050003F,
    0.004408166148421226F,
    0.0043793544002008085F,
    0.0043425447813306385F,
    0.004313021704037351F,
    0.004277538948336059F,
    0.004246605888121547F,
    0.004212599496976221F,
    0.0041830769145344F,
    0.00415055085452487F,
    0.004121331629547848F,
    0.004090979108189827F,
    0.004063820835888089F,
    0.004034201271237256F,
    0.004008344021598591F,
    0.003979429385941372F,
    0.003952329302252886F,
    0.003923934620421788F,
    0.0038955985002396354F,
    0.003866624707917216F,
    0.0038356500365063304F,
    0.0038074711535440267F,
    0.0037742544982577843F,
    0.003746978058280739F,
    0.003717670475508848F,
    0.003690503727592684F,
    0.00366497960822129F,
    0.0036476590403151086F,
    0.0036286548061116365F,
    0.0036180717976579107F,
    0.003602406370502538F,
    0.00359718205409165F,
    0.0035762596842920514F,
    0.0035640866076755056F,
    0.003518558778359206F,
    0.0034944358823863035F,
    0.003430903615641381F,
    0.003546069865881963F,
    0.0034990187398764353F,
    0.003448782878617229F,
    0.003479402664862403F,
    0.003452116145944299F,
    0.003467393510700349F,
    0.003451050121099712F,
    0.0034643361610111898F,
    0.003455234234326036F,
    0.003470707826940319F,
    0.003468793326947618F,
    0.003486395831616725F,
    0.0034895835253870356F,
    0.003511820131210432F,
    0.003522367354657968F,
    0.003548563821107134F,
    0.003565258802830846F,
    0.0035985492633442825F,
    0.0036211064703474335F,
    0.0036614145330934452F,
    0.0036913591955434924F,
    0.0037378353735095984F,
    0.0037753548158881343F,
    0.0038295029399845744F,
    0.0038758285248826395F,
    0.0039370962752445565F,
    0.003993925312795654F,
    0.004063282022264177F,
    0.004129238097103514F,
    0.004211089968166164F,
    0.004286707631646745F,
    0.004378147037291539F,
    0.004465872524404819F,
    0.00457088504327278F,
    0.004670959581939623F,
    0.0047879388073091955F,
    0.004901117371223843F,
    0.005032224083458147F,
    0.005160808873442963F,
    0.005307622854613014F,
    0.005452442175058255F,
    -0.09390677613023295F,
};

}

namespace audio
{
namespace filters
{

std::vector<float> filter_buffer(lowpas180FIR_constants.size());
std::uint32_t buffer_point = 0;
std::vector<float> lowpass(const std::vector<float> to_filter)
{
  std::vector<float> filtered;
  for(float sample: to_filter)
  {
    float result = 0.0F;
    for(uint32_t i = 0, buffer_pointer = buffer_point; i < lowpas180FIR_constants.size(); i++)
    {
      result += filter_buffer[buffer_pointer]*lowpas180FIR_constants[i];
      buffer_pointer += 1;
      buffer_pointer %= lowpas180FIR_constants.size();
    }
    filtered.push_back(result);
    filter_buffer[buffer_point] = sample;
    buffer_point += 1;
    buffer_point %= lowpas180FIR_constants.size();
  }
  return filtered;
}
}
}