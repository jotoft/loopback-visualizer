#include <audio_filters/filters.h>
#include <vector>

namespace
{
// FIR filter Equiripple Fpass 180Hz Fstop 400Hz
const std::vector<float> lowpas180FIR_constants = {
    0.013867166026352028F,
    -0.0030270975124599545F,
    -0.0027406343944884845F,
    -0.002498992000584715F,
    -0.002295086689284627F,
    -0.002124984084089238F,
    -0.001982981548333204F,
    -0.0018663980271248098F,
    -0.0017704542079909674F,
    -0.0016935906320908398F,
    -0.0016320268648765807F,
    -0.0015846048790316535F,
    -0.0015481436779812955F,
    -0.0015223102031860717F,
    -0.0015044386999045513F,
    -0.0014944153107199756F,
    -0.0014896763629732785F,
    -0.0014905623706474825F,
    -0.0014948552439753952F,
    -0.0015032523773156673F,
    -0.0015135452871817383F,
    -0.0015266676510305747F,
    -0.001540417954324763F,
    -0.0015560528188999316F,
    -0.001571368875382286F,
    -0.0015879511892232996F,
    -0.0016033920777164142F,
    -0.001619504847688324F,
    -0.0016336660418178224F,
    -0.001648168918973219F,
    -0.001660037213108431F,
    -0.0016718979626655199F,
    -0.0016802824773608988F,
    -0.0016887131306302897F,
    -0.0016931386723602687F,
    -0.0016977434915090872F,
    -0.0016970443657213395F,
    -0.001696997112167422F,
    -0.001690574459704803F,
    -0.0016862679968556963F,
    -0.0016719369007200584F,
    -0.0016664904720785681F,
    -0.0016382024028993403F,
    -0.0016291211316251373F,
    -0.0016094849844475382F,
    -0.0015696853580775586F,
    -0.0015446741978852564F,
    -0.0015148550944430329F,
    -0.0014818329337368296F,
    -0.0014370190805574527F,
    -0.0013904987054368715F,
    -0.0013393096814447918F,
    -0.001289271059986923F,
    -0.0012341248239037907F,
    -0.0011765335024177348F,
    -0.0011115728959255053F,
    -0.0010429685459820031F,
    -0.0009678709138054044F,
    -0.0008903608857201417F,
    -0.0008080737608773295F,
    -0.0007240500041011433F,
    -0.0006352440948222715F,
    -0.0005436231336939298F,
    -0.0004462557347190649F,
    -0.0003452036673472499F,
    -0.00023831873534940689F,
    -0.0001278831836205891F,
    -1.2172926232413058e-05F,
    0.00010672882565992361F,
    0.00023035698910376165F,
    0.0003567945341954294F,
    0.0004874593390180456F,
    0.0006209970908414817F,
    0.0007590003196620545F,
    0.0009003442507431097F,
    0.0010460332713627043F,
    0.001195037456997577F,
    0.0013482743515683612F,
    0.001505132995525467F,
    0.001665633013470259F,
    0.0018292421996026706F,
    0.0019957470008351275F,
    0.0021662346866639023F,
    0.0023382119095541397F,
    0.0025136802024784354F,
    0.002692431055680242F,
    0.0028691561415882093F,
    0.0030556220741550857F,
    0.003238534529833021F,
    0.003424733702436464F,
    0.0036135052080332256F,
    0.0038069863383502728F,
    0.003998993567079897F,
    0.004193394646973483F,
    0.004388055807890042F,
    0.004586603920524534F,
    0.004785055781229473F,
    0.004985156703710067F,
    0.0051837181305419994F,
    0.005383771018248267F,
    0.005583060065680601F,
    0.0057840844593372315F,
    0.005983987306773851F,
    0.006184720258983097F,
    0.006383553926348209F,
    0.006582630920864207F,
    0.006779695378968565F,
    0.0069770766827858995F,
    0.007172578324212855F,
    0.007368145509644497F,
    0.007561215764270953F,
    0.0077533776569237356F,
    0.007942189269936652F,
    0.008129643597757636F,
    0.008313879093317256F,
    0.008496922270719978F,
    0.008676459162706552F,
    0.00885396574129121F,
    0.009027265419528531F,
    0.009198283167035096F,
    0.00936492552059323F,
    0.009528584273495714F,
    0.0096870453913625F,
    0.009842520382318998F,
    0.00999342985856332F,
    0.010141251745579938F,
    0.010282633652340067F,
    0.010422323775888226F,
    0.010554502574356238F,
    0.010684320930032588F,
    0.010807357945898745F,
    0.010925590090336093F,
    0.011037813784510561F,
    0.011146859341151378F,
    0.01124788023007623F,
    0.011344732444047326F,
    0.011435267267812533F,
    0.011521601811124205F,
    0.011600455190413566F,
    0.011674079933491037F,
    0.011740642788635562F,
    0.011802679347550298F,
    0.011857611565899982F,
    0.011907069598256118F,
    0.011948629824973304F,
    0.011984595152290578F,
    0.012013072095639763F,
    0.012036299203648862F,
    0.01205211316441053F,
    0.012062515351530292F,
    0.012065294439977765F,
    0.012062515351530292F,
    0.01205211316441053F,
    0.012036299203648862F,
    0.012013072095639763F,
    0.011984595152290578F,
    0.011948629824973304F,
    0.011907069598256118F,
    0.011857611565899982F,
    0.011802679347550298F,
    0.011740642788635562F,
    0.011674079933491037F,
    0.011600455190413566F,
    0.011521601811124205F,
    0.011435267267812533F,
    0.011344732444047326F,
    0.01124788023007623F,
    0.011146859341151378F,
    0.011037813784510561F,
    0.010925590090336093F,
    0.010807357945898745F,
    0.010684320930032588F,
    0.010554502574356238F,
    0.010422323775888226F,
    0.010282633652340067F,
    0.010141251745579938F,
    0.00999342985856332F,
    0.009842520382318998F,
    0.0096870453913625F,
    0.009528584273495714F,
    0.00936492552059323F,
    0.009198283167035096F,
    0.009027265419528531F,
    0.00885396574129121F,
    0.008676459162706552F,
    0.008496922270719978F,
    0.008313879093317256F,
    0.008129643597757636F,
    0.007942189269936652F,
    0.0077533776569237356F,
    0.007561215764270953F,
    0.007368145509644497F,
    0.007172578324212855F,
    0.0069770766827858995F,
    0.006779695378968565F,
    0.006582630920864207F,
    0.006383553926348209F,
    0.006184720258983097F,
    0.005983987306773851F,
    0.0057840844593372315F,
    0.005583060065680601F,
    0.005383771018248267F,
    0.0051837181305419994F,
    0.004985156703710067F,
    0.004785055781229473F,
    0.004586603920524534F,
    0.004388055807890042F,
    0.004193394646973483F,
    0.003998993567079897F,
    0.0038069863383502728F,
    0.0036135052080332256F,
    0.003424733702436464F,
    0.003238534529833021F,
    0.0030556220741550857F,
    0.0028691561415882093F,
    0.002692431055680242F,
    0.0025136802024784354F,
    0.0023382119095541397F,
    0.0021662346866639023F,
    0.0019957470008351275F,
    0.0018292421996026706F,
    0.001665633013470259F,
    0.001505132995525467F,
    0.0013482743515683612F,
    0.001195037456997577F,
    0.0010460332713627043F,
    0.0009003442507431097F,
    0.0007590003196620545F,
    0.0006209970908414817F,
    0.0004874593390180456F,
    0.0003567945341954294F,
    0.00023035698910376165F,
    0.00010672882565992361F,
    -1.2172926232413058e-05F,
    -0.0001278831836205891F,
    -0.00023831873534940689F,
    -0.0003452036673472499F,
    -0.0004462557347190649F,
    -0.0005436231336939298F,
    -0.0006352440948222715F,
    -0.0007240500041011433F,
    -0.0008080737608773295F,
    -0.0008903608857201417F,
    -0.0009678709138054044F,
    -0.0010429685459820031F,
    -0.0011115728959255053F,
    -0.0011765335024177348F,
    -0.0012341248239037907F,
    -0.001289271059986923F,
    -0.0013393096814447918F,
    -0.0013904987054368715F,
    -0.0014370190805574527F,
    -0.0014818329337368296F,
    -0.0015148550944430329F,
    -0.0015446741978852564F,
    -0.0015696853580775586F,
    -0.0016094849844475382F,
    -0.0016291211316251373F,
    -0.0016382024028993403F,
    -0.0016664904720785681F,
    -0.0016719369007200584F,
    -0.0016862679968556963F,
    -0.001690574459704803F,
    -0.001696997112167422F,
    -0.0016970443657213395F,
    -0.0016977434915090872F,
    -0.0016931386723602687F,
    -0.0016887131306302897F,
    -0.0016802824773608988F,
    -0.0016718979626655199F,
    -0.001660037213108431F,
    -0.001648168918973219F,
    -0.0016336660418178224F,
    -0.001619504847688324F,
    -0.0016033920777164142F,
    -0.0015879511892232996F,
    -0.001571368875382286F,
    -0.0015560528188999316F,
    -0.001540417954324763F,
    -0.0015266676510305747F,
    -0.0015135452871817383F,
    -0.0015032523773156673F,
    -0.0014948552439753952F,
    -0.0014905623706474825F,
    -0.0014896763629732785F,
    -0.0014944153107199756F,
    -0.0015044386999045513F,
    -0.0015223102031860717F,
    -0.0015481436779812955F,
    -0.0015846048790316535F,
    -0.0016320268648765807F,
    -0.0016935906320908398F,
    -0.0017704542079909674F,
    -0.0018663980271248098F,
    -0.001982981548333204F,
    -0.002124984084089238F,
    -0.002295086689284627F,
    -0.002498992000584715F,
    -0.0027406343944884845F,
    -0.0030270975124599545F,
    0.013867166026352028F,
};
}

namespace audio
{
namespace filters
{

std::vector<float> filter_buffer(lowpas180FIR_constants.size());
std::uint32_t buffer_point = 0;
std::vector<float> lowpass(const std::vector<float> to_filter)
{
  std::vector<float> filtered;
  for(float sample: to_filter)
  {
    float result = 0.0F;
    for(uint32_t i = 0, buffer_pointer = buffer_point; i < lowpas180FIR_constants.size(); i++)
    {
      result += filter_buffer[buffer_pointer]*lowpas180FIR_constants[i];
      buffer_pointer += 1;
      buffer_pointer %= lowpas180FIR_constants.size();
    }
    filtered.push_back(result);
    filter_buffer[buffer_point] = sample;
    buffer_point += 1;
    buffer_point %= lowpas180FIR_constants.size();
  }
  return filtered;
}
}
}